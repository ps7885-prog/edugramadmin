<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Games - Edugram Admin</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<nav class="navbar navbar-expand-md navbar-dark bg-primary">
  <div class="container-fluid">
    <a class="navbar-brand" href="index.html">Edugram Admin</a>
  </div>
</nav>
<main class="container py-4">
  <h3>Games</h3>
  <div id="games-list" class="row gy-3"></div>
</main>
<script>
const API = '../api/index.php?route=';
async function render(){
  const games = await (await fetch(API+'games')).json();
  const container = document.getElementById('games-list');
  for(const g of games){
    const div = document.createElement('div'); div.className='col-12 col-md-6';
    div.innerHTML = `<div class="card p-3"><h5>${g.name}</h5><p class="text-muted">${g.description||''}</p><div id="scores-${g.id}">Loading...</div></div>`;
    container.appendChild(div);
    // load scores
    const route = `games/game${g.id}/scores`;
    const scores = await (await fetch(API+route)).json();
    document.getElementById(`scores-${g.id}`).innerHTML = '<ul>'+scores.slice(0,10).map(s=>`<li>${s.student_name} â€” ${s.score} (${s.subject||''})</li>`).join('')+'</ul>';
  }
}
render().catch(console.error);
</script>
</body>
</html>
